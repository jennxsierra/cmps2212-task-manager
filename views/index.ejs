<!-- Filename: views/index.ejs -->
<%- include('partials/header', { pageTitle: 'Home - Task Manager' }) %>

<section class="task-section">
  <h2>Add New Task</h2>
  <form action="/add-task" method="POST" class="task-form">
    <label for="title">Title:</label>
    <input type="text" name="title" id="title" required />

    <label for="description">Description (optional):</label>
    <textarea name="description" id="description"></textarea>

    <button type="submit">Add Task</button>
  </form>
</section>

<section class="task-list-section">
  <h2>Task List</h2>
  <% if (tasks.length === 0) { %>
  <p>No tasks available.</p>
  <% } else { %>
  <ul class="task-list">
    <% tasks.forEach(task => { %>
    <li class="task-item">
      <div class="task-details <%= task.completed ? 'completed' : '' %>">
        <strong><%= task.title %></strong>
        <% if (task.description) { %>
        <p><%= task.description %></p>
        <% } %>
      </div>
      <div class="task-actions">
        <!-- Complete form -->
        <form action="/toggle-task/<%= task.id %>" method="POST">
          <button
            type="submit"
            class="<%= task.completed ? 'gray-button' : 'green-button' %>"
          >
            <%= task.completed ? 'Reopen' : 'Complete' %>
          </button>
        </form>
        <!-- Delete form -->
        <form action="/delete-task/<%= task.id %>" method="POST">
          <button type="submit" class="delete-button">Delete</button>
        </form>
      </div>
    </li>
    <% }); %>
  </ul>
  <% } %>
</section>

<%- include('partials/footer') %>
